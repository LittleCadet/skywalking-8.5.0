(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-29e66218"],{"077b":function(t,e,a){"use strict";a.r(e);var r=a("d225"),n=a("b0b4"),i=a("308d"),s=a("6bb5"),c=a("4e2b"),o=a("9ab4"),l=a("1b40"),d=a("4bb5"),h=a("3a87"),u=a("2093"),p=a("a06f"),m=function(t){function e(){return Object(r.a)(this,e),Object(i.a)(this,Object(s.a)(e).apply(this,arguments))}return Object(c.a)(e,t),Object(n.a)(e,[{key:"beforeMount",value:function(){this.SET_EVENTS([])}}]),e}(l.d);o.a([Object(d.d)("rocketTrace")],m.prototype,"stateTrace",void 0),o.a([Object(d.c)("SET_EVENTS")],m.prototype,"SET_EVENTS",void 0),o.a([Object(l.b)({default:function(){return{label:"All",key:""}}})],m.prototype,"service",void 0),o.a([Object(l.b)({default:!1,type:Boolean})],m.prototype,"beforeMount",null);var f=m=o.a([Object(l.a)({components:{TraceTable:u.a,TraceDetail:p.a,TraceSearch:h.a}})],m),g=(a("c251"),a("2877")),v=Object(g.a)(f,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"rk-trace flex-v"},[e("TraceSearch"),e("div",{staticClass:"rk-trace-inner"},[e("TraceTable"),e("TraceDetail",{attrs:{current:this.stateTrace.currentTrace,spans:this.stateTrace.traceSpans}})],1)],1)},[],!1,null,null,null);e.default=v.exports},"0c2c":function(t,e,a){},2093:function(t,e,a){"use strict";var r=a("d225"),n=a("b0b4"),i=a("308d"),s=a("6bb5"),c=a("4e2b"),o=a("9ab4"),l=a("1b40"),d=a("4bb5"),h=function(t){function e(){var t;return Object(r.a)(this,e),(t=Object(i.a)(this,Object(s.a)(e).apply(this,arguments))).loading=!1,t.selectedKey="",t}return Object(c.a)(e,t),Object(n.a)(e,[{key:"onTraceListChange",value:function(){this.rocketTrace.traceList&&this.rocketTrace.traceList.length>0&&this.selectTrace(this.rocketTrace.traceList[0]),this.rocketTrace.traceList&&0===this.rocketTrace.traceList.length&&this.SET_DEFAULT_EMPTY_TRACE()}},{key:"selectTrace",value:function(t){this.SET_CURRENT_TRACE(t),this.selectedKey=t.key,this.$eventBus.$emit("TRACE-TABLE-LOADING"),this.$eventBus.$emit("TRACE-LIST-LOADING"),t.traceIds.length&&this.GET_TRACE_SPANS({traceId:t.traceIds[0]})}},{key:"changeSort",value:function(t){this.SET_TRACE_FORM_ITEM({type:"queryOrder",data:t.target.options[t.target.selectedIndex].value}),this.SET_TRACE_FORM_ITEM({type:"paging",data:{pageNum:1,pageSize:15,needTotal:!0}}),this.GET_TRACELIST()}},{key:"page",value:function(t){var e=this;this.loading=!0,this.SET_TRACE_FORM_ITEM({type:"paging",data:{pageNum:t,pageSize:15,needTotal:!0}}),this.GET_TRACELIST().then(function(){e.loading=!1})}},{key:"created",value:function(){var t=this;this.$eventBus.$on("SET_LOADING_TRUE",this,function(e){t.loading=!0,e&&e()}),this.$eventBus.$on("SET_LOADING_FALSE",this,function(){t.loading=!1})}}]),e}(l.d);o.a([Object(d.d)("rocketTrace")],h.prototype,"rocketTrace",void 0),o.a([Object(d.c)("rocketTrace/SET_TRACE_FORM_ITEM")],h.prototype,"SET_TRACE_FORM_ITEM",void 0),o.a([Object(d.c)("rocketTrace/SET_CURRENT_TRACE")],h.prototype,"SET_CURRENT_TRACE",void 0),o.a([Object(d.c)("rocketTrace/SET_DEFAULT_EMPTY_TRACE")],h.prototype,"SET_DEFAULT_EMPTY_TRACE",void 0),o.a([Object(d.a)("rocketTrace/GET_TRACELIST")],h.prototype,"GET_TRACELIST",void 0),o.a([Object(d.a)("rocketTrace/GET_TRACE_SPANS")],h.prototype,"GET_TRACE_SPANS",void 0),o.a([Object(l.e)("rocketTrace.traceList")],h.prototype,"onTraceListChange",null);var u=h=o.a([l.a],h),p=(a("92d4"),a("2877")),m=Object(p.a)(u,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rk-trace-t flex-v"},[a("div",{staticClass:"rk-trace-t-tool flex-h"},[a("RkPage",{attrs:{currentSize:15,currentPage:t.rocketTrace.traceForm.paging.pageNum,total:t.rocketTrace.traceTotal},on:{changePage:t.page}}),a("select",{staticClass:"grey",domProps:{value:t.rocketTrace.traceForm.queryOrder},on:{change:t.changeSort}},[a("option",{attrs:{value:"BY_START_TIME"}},[t._v(t._s(t.$t("startTime")))]),a("option",{attrs:{value:"BY_DURATION"}},[t._v(t._s(t.$t("duration")))])])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"rk-trace-t-loading"},[a("svg",{staticClass:"icon loading"},[a("use",{attrs:{"xlink:href":"#spinner"}})])]),a("div",{staticClass:"rk-trace-t-wrapper scroll_hide"},[a("table",{staticClass:"rk-trace-t"},t._l(t.rocketTrace.traceList,function(e,r){return a("tr",{key:r,staticClass:"rk-trace-tr cp",on:{click:function(a){return t.selectTrace(e)}}},[a("td",{staticClass:"rk-trace-td",class:{"rk-trace-success":!e.isError,"rk-trace-error":e.isError,selected:t.selectedKey==e.key}},[a("div",{staticClass:"ell mb-5",class:{blue:!e.isError,red:e.isError}},[a("span",{staticClass:"b"},[t._v(t._s(e.endpointNames[0]))])]),a("div",{staticClass:"grey ell sm"},[a("span",{staticClass:"rk-tag mr-10 sm"},[t._v(t._s(e.duration)+" ms")]),t._v(t._s(t._f("dateformat")(parseInt(e.start)))+"\n          ")])])])}),0)])])},[],!1,null,null,null);e.a=m.exports},"23c5":function(t,e,a){},"26a4":function(t,e,a){},"2b1b":function(t,e,a){},"3a87":function(t,e,a){"use strict";var r=a("f499"),n=a.n(r),i=a("e814"),s=a.n(i),c=(a("6b54"),a("d225")),o=a("b0b4"),l=a("308d"),d=a("6bb5"),h=a("4e2b"),u=a("9ab4"),p=a("1b40"),m=a("4bb5"),f=a("a0f3"),g=a("2ea0"),v=function(t){function e(){var t;return Object(c.a)(this,e),(t=Object(l.a)(this,Object(d.a)(e).apply(this,arguments))).service={label:"All",key:""},t.status=!0,t.maxTraceDuration=localStorage.getItem("maxTraceDuration")||"",t.minTraceDuration=localStorage.getItem("minTraceDuration")||"",t.instance={label:"All",key:""},t.endpointName=localStorage.getItem("endpointName")||"",t.traceId=localStorage.getItem("traceId")||"",t.traceState={label:"All",key:"ALL"},t.tags="",t.tagsList=[],t}return Object(h.a)(e,t),Object(o.a)(e,[{key:"created",value:function(){this.endpointName=this.$route.query.endpointname?this.$route.query.endpointname.toString():this.endpointName,this.traceId=this.$route.query.traceid?this.$route.query.traceid.toString():this.traceId,this.time=[this.rocketbotGlobal.durationRow.start,this.rocketbotGlobal.durationRow.end],this.tagsList=localStorage.getItem("traceTags")?JSON.parse(localStorage.getItem("traceTags")||""):[]}},{key:"mounted",value:function(){this.getTraceList(),this.service&&this.service.key&&this.GET_INSTANCES({duration:this.durationTime,serviceId:this.service.key})}},{key:"globalTimeFormat",value:function(t){var e="MINUTE",a=Math.round(t[1].getTime())-Math.round(t[0].getTime());return e=a<=36e5?"MINUTE":a<=864e5?"HOUR":"DAY",{start:Object(g.b)(t[0],e,!1),end:Object(g.b)(t[1],e,!1),step:e}}},{key:"chooseService",value:function(t){this.service.key!==t.key&&(this.instance={label:"All",key:""},this.service=t,""!==t.key?this.GET_INSTANCES({duration:this.durationTime,serviceId:t.key}):this.SET_INSTANCES([]))}},{key:"chooseStatus",value:function(t){this.traceState=t}},{key:"getTraceList",value:function(){var t=this;this.GET_SERVICES({duration:this.durationTime});var e={queryDuration:this.globalTimeFormat([new Date(this.time[0].getTime()+36e5*(s()(String(this.rocketbotGlobal.utc),10)+(new Date).getTimezoneOffset()/60)),new Date(this.time[1].getTime()+36e5*(s()(String(this.rocketbotGlobal.utc),10)+(new Date).getTimezoneOffset()/60))]),traceState:this.traceState.key,paging:{pageNum:1,pageSize:15,needTotal:!0},queryOrder:this.rocketTrace.traceForm.queryOrder};if(this.service.key&&(e.serviceId=this.service.key),this.instance.key&&(e.serviceInstanceId=this.instance.key),this.maxTraceDuration&&(e.maxTraceDuration=this.maxTraceDuration,localStorage.setItem("maxTraceDuration",this.maxTraceDuration)),this.minTraceDuration&&(e.minTraceDuration=this.minTraceDuration,localStorage.setItem("minTraceDuration",this.minTraceDuration)),this.endpointName&&(e.endpointName=this.endpointName,localStorage.setItem("endpointName",this.endpointName)),this.traceId&&(e.traceId=this.traceId,localStorage.setItem("traceId",this.traceId)),this.tagsList.length){var a=this.tagsList.map(function(t){return{key:t.substring(0,t.indexOf("=")),value:t.substring(t.indexOf("=")+1,t.length)}});e.tags=a,localStorage.setItem("traceTags",n()(this.tagsList))}this.SET_TRACE_FORM(e),this.$eventBus.$emit("SET_LOADING_TRUE",function(){t.GET_TRACELIST().then(function(){t.$eventBus.$emit("SET_LOADING_FALSE")})})}},{key:"clearSearch",value:function(){this.RESET_DURATION(),this.status=!0,this.maxTraceDuration="",localStorage.removeItem("maxTraceDuration"),this.minTraceDuration="",localStorage.removeItem("minTraceDuration"),this.service={label:"All",key:""},this.instance={label:"All",key:""},this.endpointName="",localStorage.removeItem("endpointName"),this.tagsList=[],localStorage.removeItem("traceTags"),this.traceId="",localStorage.removeItem("traceId"),this.traceState={label:"All",key:"ALL"},this.SET_TRACE_FORM_ITEM({type:"queryOrder",data:""}),this.getTraceList()}},{key:"addLabels",value:function(t){13===t.keyCode&&this.tags&&(this.tagsList.push(this.tags),this.tags="")}},{key:"removeTags",value:function(t){this.tagsList.splice(t,1),localStorage.setItem("traceTags",n()(this.tagsList))}},{key:"durationRowWatch",value:function(t){this.time=[t.start,t.end]}}]),e}(p.d);u.a([Object(m.d)("rocketbot")],v.prototype,"rocketbotGlobal",void 0),u.a([Object(m.d)("rocketTrace")],v.prototype,"rocketTrace",void 0),u.a([Object(m.b)("durationTime")],v.prototype,"durationTime",void 0),u.a([Object(m.b)("duration")],v.prototype,"duration",void 0),u.a([Object(m.a)("RESET_DURATION")],v.prototype,"RESET_DURATION",void 0),u.a([Object(m.a)("rocketTrace/GET_SERVICES")],v.prototype,"GET_SERVICES",void 0),u.a([Object(m.a)("rocketTrace/GET_INSTANCES")],v.prototype,"GET_INSTANCES",void 0),u.a([Object(m.a)("rocketTrace/GET_TRACELIST")],v.prototype,"GET_TRACELIST",void 0),u.a([Object(m.a)("rocketTrace/SET_TRACE_FORM")],v.prototype,"SET_TRACE_FORM",void 0),u.a([Object(m.c)("rocketTrace/SET_TRACE_FORM_ITEM")],v.prototype,"SET_TRACE_FORM_ITEM",void 0),u.a([Object(m.c)("rocketTrace/SET_INSTANCES")],v.prototype,"SET_INSTANCES",void 0),u.a([Object(p.e)("rocketbotGlobal.durationRow")],v.prototype,"durationRowWatch",null);var T=v=u.a([Object(p.a)({components:{TraceSelect:f.a}})],v),y=(a("e63d"),a("2877")),S=Object(y.a)(T,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rk-trace-search"},[a("div",[a("a",{staticClass:"rk-trace-clear-btn r",on:{click:function(e){t.status=!t.status}}},[a("span",{staticClass:"mr-5 vm"},[t._v(t._s(t.$t("more")))]),a("svg",{staticClass:"icon trans vm",style:"transform: rotate("+(t.status?180:0)+"deg);"},[a("use",{attrs:{"xlink:href":"#arrow-down"}})])]),a("a",{staticClass:"rk-trace-search-btn bg-blue r mr-10",on:{click:t.getTraceList}},[a("svg",{staticClass:"icon mr-5 vm"},[a("use",{attrs:{"xlink:href":"#search"}})]),a("span",{staticClass:"vm"},[t._v(t._s(t.$t("search")))])]),a("a",{staticClass:"rk-trace-clear-btn r mr-10",on:{click:t.clearSearch}},[a("svg",{staticClass:"icon mr-5 vm"},[a("use",{attrs:{"xlink:href":"#clear"}})]),a("span",{staticClass:"vm"},[t._v(t._s(t.$t("clear")))])]),a("div",{staticClass:"flex-h"},[a("TraceSelect",{attrs:{hasSearch:!0,title:t.$t("service"),value:t.service,data:t.rocketTrace.services},on:{input:t.chooseService}}),a("TraceSelect",{attrs:{hasSearch:!0,title:t.$t("instance"),data:t.rocketTrace.instances},model:{value:t.instance,callback:function(e){t.instance=e},expression:"instance"}}),a("TraceSelect",{attrs:{title:t.$t("status"),value:t.traceState,data:[{label:"All",key:"ALL"},{label:"Success",key:"SUCCESS"},{label:"Error",key:"ERROR"}]},on:{input:t.chooseStatus}}),a("div",{staticClass:"mr-10",staticStyle:{padding:"3px 15px 0"}},[a("div",{staticClass:"sm grey"},[t._v(t._s(t.$t("endpointName")))]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.endpointName,expression:"endpointName"}],staticClass:"rk-trace-search-input",attrs:{type:"text"},domProps:{value:t.endpointName},on:{input:function(e){e.target.composing||(t.endpointName=e.target.value)}}})])],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.status,expression:"status"}],staticClass:"rk-trace-search-more"},[a("div",{staticClass:"flex-h"},[a("div",{staticClass:"mr-15"},[a("span",{staticClass:"sm b grey mr-10"},[t._v(t._s(t.$t("traceID"))+":")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.traceId,expression:"traceId"}],staticClass:"rk-trace-search-input dib",attrs:{type:"text"},domProps:{value:t.traceId},on:{input:function(e){e.target.composing||(t.traceId=e.target.value)}}})]),a("div",{staticClass:"mr-15"},[a("span",{staticClass:"sm b grey mr-10"},[t._v(t._s(t.$t("duration"))+":")]),a("div",{staticClass:"rk-trace-search-range dib"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.minTraceDuration,expression:"minTraceDuration"}],staticClass:"vm tc",domProps:{value:t.minTraceDuration},on:{input:function(e){e.target.composing||(t.minTraceDuration=e.target.value)}}}),a("span",{staticClass:"grey vm"},[t._v("-")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.maxTraceDuration,expression:"maxTraceDuration"}],staticClass:"vm tc",domProps:{value:t.maxTraceDuration},on:{input:function(e){e.target.composing||(t.maxTraceDuration=e.target.value)}}})])]),a("div",[a("span",{staticClass:"sm b grey mr-5"},[t._v(t._s(t.$t("timeRange"))+":")]),a("RkDate",{staticClass:"sm",attrs:{position:"bottom",format:"YYYY-MM-DD HH:mm"},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})],1)]),a("div",{staticClass:"flex-h"},[a("div",{staticClass:"mr-10",staticStyle:{"padding-top":"5px"}},[a("span",{staticClass:"sm grey"},[t._v(t._s(t.$t("tags"))+": ")]),a("span",{staticClass:"rk-trace-tags"},t._l(t.tagsList,function(e,r){return a("span",{key:r,staticClass:"selected"},[a("span",[t._v(t._s(e))]),a("span",{staticClass:"remove-icon",on:{click:function(e){return t.removeTags(r)}}},[t._v("×")])])}),0),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tags,expression:"tags"}],staticClass:"rk-trace-new-tag",attrs:{type:"text",placeholder:t.$t("addTag")},domProps:{value:t.tags},on:{keyup:t.addLabels,input:function(e){e.target.composing||(t.tags=e.target.value)}}}),a("span",{directives:[{name:"tooltip",rawName:"v-tooltip:bottom",value:{content:t.$t("traceTagsTip")},expression:"{ content: $t('traceTagsTip') }",arg:"bottom"}],staticClass:"trace-tips"},[a("a",{attrs:{target:"blank",href:"https://github.com/apache/skywalking/blob/master/docs/en/setup/backend/configuration-vocabulary.md"}},[t._v("\n            "+t._s(t.$t("tagsLink"))+"\n          ")]),a("rk-icon",{staticClass:"mr-5",attrs:{icon:"help"}})],1)])])])])},[],!1,null,null,null);e.a=S.exports},"65ce":function(t,e,a){"use strict";var r=a("23c5");a.n(r).a},"7e8c":function(t,e,a){},"92d4":function(t,e,a){"use strict";var r=a("0c2c");a.n(r).a},a06f:function(t,e,a){"use strict";var r=a("d225"),n=a("b0b4"),i=a("308d"),s=a("6bb5"),c=a("4e2b"),o=a("9ab4"),l=a("1b40"),d=(a("55dd"),a("75fc")),h=a("cebc"),u=(a("7514"),a("20d6"),a("b6d0")),p=a.n(u),m=a("774e"),f=a.n(m),g=(a("ac6a"),a("d0ab")),v=a("5698"),T=a("6a04"),y=function(){function t(e,a){Object(r.a)(this,t),this.barHeight=48,this.show=a,this.el=e,this.i=0,this.width=e.clientWidth,this.height=e.clientHeight,this.svg=v.select(this.el).append("svg").attr("class","trace-list-dowanload").attr("width",this.width).attr("height",this.height),this.treemap=v.tree().size([.7*this.height,this.width]),this.tip=Object(T.a)().attr("class","d3-tip").offset([-8,0]).html(function(t){return'\n      <div class="mb-5">'.concat(t.data.label,"</div>\n      ").concat(t.data.dur?'<div class="sm">SelfDuration: '+t.data.dur+"ms</div>":"","\n      ").concat(t.data.endTime-t.data.startTime?'<div class="sm">TotalDuration: '+(t.data.endTime-t.data.startTime)+"ms</div>":"","\n      ")}),this.svg.call(this.tip)}return Object(n.a)(t,[{key:"diagonal",value:function(t){return"M ".concat(t.source.y," ").concat(t.source.x+5,"\n    L ").concat(t.source.y," ").concat(t.target.x-30,"\n    L").concat(t.target.y," ").concat(t.target.x-20,"\n    L").concat(t.target.y," ").concat(t.target.x-5)}},{key:"init",value:function(t,e,a){var r=this;v.select(".trace-xaxis").remove(),this.row=e,this.data=t,this.min=v.min(this.row.map(function(t){return t.startTime})),this.max=v.max(this.row.map(function(t){return t.endTime-r.min})),this.list=f()(new p.a(this.row.map(function(t){return t.serviceCode}))),this.xScale=v.scaleLinear().range([0,.387*this.width]).domain([0,this.max]),this.xAxis=v.axisTop(this.xScale).tickFormat(function(t){return 0===t?0:t>=1e3?t/1e3+"s":t}),this.svg.attr("height",(this.row.length+a+1)*this.barHeight),this.svg.append("g").attr("class","trace-xaxis").attr("transform","translate(".concat(.618*this.width-20,",",30,")")).call(this.xAxis),this.sequentialScale=v.scaleSequential().domain([0,this.list.length+1]).interpolator(v.interpolateCool),this.root=v.hierarchy(this.data,function(t){return t.children}),this.root.x0=0,this.root.y0=0}},{key:"draw",value:function(t){this.update(this.root,t)}},{key:"click",value:function(t,e){t.data.type&&(t.children?(t._children=t.children,t.children=null):(t.children=t._children,t._children=null),e.update(t))}},{key:"update",value:function(t,e){var a=this,r=this,n=this.root.descendants(),i=-1;this.root.eachBefore(function(t){t.x=++i*a.barHeight+24,t.y=12*t.depth});var s=this.svg.selectAll(".trace-node").data(n,function(t){return t.id||(t.id=++a.i)}),c=s.enter().append("g").attr("transform","translate(".concat(t.y0,",").concat(t.x0,")")).attr("class","trace-node").style("opacity",0).on("mouseover",function(t,e){r.tip.show(t,this)}).on("mouseout",function(t,e){r.tip.hide(t,this)}).on("click",function(t){r.show.handleSelectSpan(t)});c.append("rect").attr("height",42).attr("ry",2).attr("rx",2).attr("y",-22).attr("x",20).attr("width","100%").attr("fill","rgba(0,0,0,0)"),c.append("text").attr("x",13).attr("y",5).attr("fill","#E54C17").html(function(t){return t.data.isError?"◉":""}),c.append("text").attr("class","node-text").attr("x",35).attr("y",-6).attr("fill","#333").text(function(t){return"TRACE_ROOT"===t.data.label?"":t.data.label.length>40?"".concat(t.data.label.slice(0,40),"..."):"".concat(t.data.label)}),c.append("text").attr("class","node-text").attr("x",35).attr("y",12).attr("fill","#ccc").style("font-size","11px").text(function(t){return"".concat(t.data.layer||""," ").concat(t.data.component?"- "+t.data.component:t.data.component||"")}),c.append("rect").attr("rx",2).attr("ry",2).attr("height",4).attr("width",function(t){return t.data.endTime&&t.data.startTime&&a.xScale(t.data.endTime-t.data.startTime)+1||0}).attr("x",function(t){return t.data.endTime&&t.data.startTime&&.618*a.width-20-t.y+a.xScale(t.data.startTime-a.min)||0}).attr("y",-2).style("fill",function(t){return"".concat(a.sequentialScale(a.list.indexOf(t.data.serviceCode)))}),c.transition().duration(400).attr("transform",function(t){return"translate(".concat(t.y,",").concat(t.x,")")}).style("opacity",1),c.append("circle").attr("r",3).style("cursor","pointer").attr("stroke-width",2.5).attr("fill",function(t){return t._children?"".concat(a.sequentialScale(a.list.indexOf(t.data.serviceCode))):"rbga(0,0,0,0)"}).style("stroke",function(t){return"TRACE_ROOT"===t.data.label?"":"".concat(a.sequentialScale(a.list.indexOf(t.data.serviceCode)))}).on("click",function(t){a.click(t,a),v.event.stopPropagation()}),s.transition().duration(400).attr("transform",function(t){return"translate(".concat(t.y,",").concat(t.x,")")}).style("opacity",1).select("circle").attr("fill",function(t){return t._children?"".concat(a.sequentialScale(a.list.indexOf(t.data.serviceCode))):""}),s.exit().transition().duration(400).attr("transform","translate(".concat(t.y,",").concat(t.x,")")).style("opacity",0).remove();var o=this.svg.selectAll(".trace-link").data(this.root.links(),function(t){return t.target.id});o.enter().insert("path","g").attr("class","trace-link").attr("fill","rgba(0,0,0,0)").attr("stroke","rgba(0, 0, 0, 0.1)").attr("stroke-width",2).attr("d",function(e){var r={x:t.x0+35,y:t.y0};return a.diagonal({source:r,target:r})}).transition().duration(400).attr("d",this.diagonal),o.transition().duration(400).attr("d",this.diagonal),o.exit().transition().duration(400).attr("d",function(e){var r={x:t.x+35,y:t.y};return a.diagonal({source:r,target:r})}).remove(),this.root.each(function(t){t.x0=t.x,t.y0=t.y}),e&&e()}}]),t}(),S=a("2ef0"),b=a.n(S),I=a("d003"),_={components:{TraceSpanLogs:I.a},props:["data","traceId"],data:function(){return{segmentId:[],showDetail:!1,list:[],currentSpan:[],loading:!0,fixSpansSize:0,showRelatedLogs:!1}},watch:{data:function(){var t=this;this.data.length&&(this.loading=!0,this.changeTree(),this.tree.init({label:"TRACE_ROOT",children:this.segmentId},this.data,this.fixSpansSize),this.tree.draw(function(){setTimeout(function(){t.loading=!1},200)}))}},beforeDestroy:function(){v.selectAll(".d3-tip").remove()},mounted:function(){var t=this;this.$eventBus.$on("TRACE-LIST-LOADING",this,function(){t.loading=!0}),this.changeTree(),this.tree=new y(this.$refs.traceList,this),this.tree.init({label:"TRACE_ROOT",children:this.segmentId},this.data,this.fixSpansSize),this.tree.draw(),this.loading=!1},methods:{handleSelectSpan:function(t){this.currentSpan=t.data,this.showDetail=!0},traverseTree:function(t,e,a,r){var n=this;t&&!t.isBroken&&(t.spanId!==e||t.segmentId!==a?t.children&&t.children.length>0&&t.children.forEach(function(t){n.traverseTree(t,e,a,r)}):t.children.push(r))},computedScale:function(t){return v.scaleSequential().domain([0,this.list.length+1]).interpolator(v.interpolateCool)(t)},changeTree:function(){var t=this;if(0===this.data.length)return[];this.list=f()(new p.a(this.data.map(function(t){return t.serviceCode}))),this.segmentId=[];var e={},a=[],r=[],n=[];for(var i in this.data.forEach(function(e){if(-1===e.parentSpanId)n.push(e);else{var a=t.data.findIndex(function(t){return t.segmentId===e.segmentId&&t.spanId===e.spanId-1}),i={traceId:e.traceId,segmentId:e.segmentId,spanId:e.spanId-1,parentSpanId:e.spanId-2};-1!==a||b.a.find(r,i)||r.push(Object(h.a)({},i,{refs:[],endpointName:"VNode: ".concat(e.segmentId),serviceCode:"VirtualNode",type:"[Broken] ".concat(e.type),peer:"",component:"VirtualNode: #".concat(e.spanId-1),isError:!0,isBroken:!0,layer:"Broken",tags:[],logs:[]}))}}),n.forEach(function(e){e.refs.length&&e.refs.forEach(function(e){if(-1===t.data.findIndex(function(t){return e.parentSegmentId===t.segmentId&&e.parentSpanId===t.spanId})){var a=e.parentSpanId,n={traceId:e.traceId,segmentId:e.parentSegmentId,spanId:a,parentSpanId:a>-1?0:-1};if(b.a.find(r,n)||r.push(Object(h.a)({},n,{refs:[],endpointName:"VNode: ".concat(e.parentSegmentId),serviceCode:"VirtualNode",type:"[Broken] ".concat(e.type),peer:"",component:"VirtualNode: #".concat(a),isError:!0,isBroken:!0,layer:"Broken",tags:[],logs:[]})),n.parentSpanId>-1){var i={traceId:e.traceId,segmentId:e.parentSegmentId,spanId:0,parentSpanId:-1};b.a.find(r,i)||r.push(Object(h.a)({},i,{refs:[],endpointName:"VNode: ".concat(e.parentSegmentId),serviceCode:"VirtualNode",type:"[Broken] ".concat(e.type),peer:"",component:"VirtualNode: #0",isError:!0,isBroken:!0,layer:"Broken",tags:[],logs:[]}))}}})}),[].concat(r,Object(d.a)(this.data)).forEach(function(t){t.label=t.endpointName||"no operation name",t.children=[],void 0===e[t.segmentId]?(a.push(t.segmentId),e[t.segmentId]=[],e[t.segmentId].push(t)):e[t.segmentId].push(t)}),this.fixSpansSize=r.length,a.forEach(function(a){var r=e[a].sort(function(t,e){return e.parentSpanId-t.parentSpanId});r.forEach(function(e){var a=r.findIndex(function(t){return t.spanId===e.parentSpanId});if(-1!==a&&(r[a].isBroken&&-1===r[a].parentSpanId||!r[a].isBroken)&&(r[a].children.push(e),r[a].children.sort(function(t,e){return t.spanId-e.spanId})),e.isBroken){var n,i=b.a.filter(t.data,function(t){return b.a.find(t.refs,{traceId:e.traceId,parentSegmentId:e.segmentId,parentSpanId:e.spanId})});if(i.length>0)(n=e.children).push.apply(n,Object(d.a)(i))}}),e[a]=r[r.length-1]}),a.forEach(function(a){e[a].refs.forEach(function(r){r.traceId===t.traceId&&t.traverseTree(e[r.parentSegmentId],r.parentSpanId,r.parentSegmentId,e[a])})}),e)0===e[i].refs.length&&this.segmentId.push(e[i]);this.segmentId.forEach(function(e){t.collapse(e)})},collapse:function(t){var e=this;if(t.children){var a=t.endTime-t.startTime;t.children.forEach(function(t){a-=t.endTime-t.startTime}),t.dur=a<0?0:a,t.children.forEach(function(t){return e.collapse(t)})}},downloadTrace:function(){var t=new XMLSerializer,e=v.select(".trace-list-dowanload").node(),a='<?xml version="1.0" standalone="no"?>\r\n'.concat(t.serializeToString(e)),r=document.createElement("canvas"),n=r.getContext("2d");r.width=v.select(".trace-list-dowanload")._groups[0][0].clientWidth,r.height=v.select(".trace-list-dowanload")._groups[0][0].clientHeight,n.fillStyle="#fff",n.fillRect(0,0,r.width,r.height);var i=new Image;i.src="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(a)),i.onload=function(){n.drawImage(i,0,0);var t=document.createElement("a");t.download="trace-list.png",t.href=r.toDataURL("image/png"),t.click()}}}},k=(a("65ce"),a("2877")),E=Object(k.a)(_,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"time-charts scroll_hide"},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"rk-trace-t-loading"},[a("svg",{staticClass:"icon loading"},[a("use",{attrs:{"xlink:href":"#spinner"}})])]),a("transition-group",{staticClass:"mb-5",attrs:{name:"fade",tag:"a"}},t._l(t.list,function(e,r){return a("span",{key:e,staticClass:"time-charts-item mr-10",style:"color:"+t.computedScale(r)},[a("svg",{staticClass:"icon vm mr-5 sm"},[a("use",{attrs:{"xlink:href":"#issue-open-m"}})]),a("span",[t._v(t._s(e))])])}),0),a("a",{staticClass:"rk-btn r vm  tc",on:{click:t.downloadTrace}},[t._v(t._s(t.$t("exportImage")))]),a("rk-sidebox",{attrs:{width:"50%",show:t.showDetail,title:t.$t("spanInfo")},on:{"update:show":function(e){t.showDetail=e}}},[a("TraceSpanLogs",{attrs:{currentSpan:t.currentSpan}})],1),a("div",{staticClass:"trace-list"},[a("div",{ref:"traceList"})])],1)},[],!1,null,null,null).exports,C=(a("28a5"),0),x=function(){function t(e,a){Object(r.a)(this,t),this.el=e,this.scope=a,this.i=0,this.topSlow=[],this.topChild=[],this.width=e.clientWidth,this.height=e.clientHeight-28,this.body=v.select(this.el).append("svg").attr("width",this.width).attr("height",this.height),this.tip=Object(T.a)().attr("class","d3-tip").offset([-8,0]).html(function(t){return'\n      <div class="mb-5">'.concat(t.data.label,"</div>\n      ").concat(t.data.dur?'<div class="sm">SelfDuration: '+t.data.dur+"ms</div>":"","\n      ").concat(t.data.endTime-t.data.startTime?'<div class="sm">TotalDuration: '+(t.data.endTime-t.data.startTime)+"ms</div>":"","\n      ")}),this.svg=this.body.append("g").attr("transform",function(t){return"translate(120, 0)"}),this.svg.call(this.tip)}return Object(n.a)(t,[{key:"resize",value:function(){this.width=this.el.clientWidth,this.height=this.el.clientHeight-28,this.body.attr("width",this.width).attr("height",this.height),this.body.select("g").attr("transform",function(t){return"translate(160, 0)"});var t=v.zoomTransform(0).translate(0,0);v.zoom().transform(this.body,t)}},{key:"init",value:function(t,e){var a=this;this.treemap=v.tree().size([35*e.length,this.width]),this.row=e,this.data=t,this.min=v.min(this.row.map(function(t){return t.startTime})),this.max=v.max(this.row.map(function(t){return t.endTime-a.min})),this.list=f()(new p.a(this.row.map(function(t){return t.serviceCode}))),this.xScale=v.scaleLinear().range([0,100]).domain([0,this.max]),this.sequentialScale=v.scaleSequential().domain([0,this.list.length+1]).interpolator(v.interpolateCool),this.body.call(this.getZoomBehavior(this.svg)),this.root=v.hierarchy(this.data,function(t){return t.children}),this.root.x0=this.height/2,this.root.y0=0,this.topSlow=[],this.topChild=[];var r=this;this.root.children.forEach(function t(e){if(e.children){var a=e.data.endTime-e.data.startTime;e.children.forEach(function(t){a-=t.data.endTime-t.data.startTime}),e.dur=a<0?0:a,r.topSlow.push(a),r.topChild.push(e.children.length),e.childrenLength=e.children.length,e.children.forEach(t)}}),this.topSlowMax=this.topSlow.sort(function(t,e){return e-t})[0],this.topSlowMin=this.topSlow.sort(function(t,e){return e-t})[4],this.topChildMax=this.topChild.sort(function(t,e){return e-t})[0],this.topChildMin=this.topChild.sort(function(t,e){return e-t})[4],this.update(this.root)}},{key:"draw",value:function(){this.update(this.root)}},{key:"update",value:function(t){var e=this,a=this,r=this.treemap(this.root),n=r.descendants(),i=r.descendants().slice(1);n.forEach(function(t){t.y=140*t.depth});var s=this.svg.selectAll("g.node").data(n,function(t){return t.id||(t.id=++C)}),c=s.enter().append("g").attr("class","node").attr("cursor","pointer").attr("transform",function(e){return"translate("+t.y0+","+t.x0+")"}).on("mouseover",function(t,e){if(a.tip.show(t,this),a.timeUpdate){var r=a.timeUpdate._groups[0].filter(function(t){return t.__data__.id===e+1});r.length&&a.timeTip.show(t,r[0].children[1])}}).on("mouseout",function(t,e){if(a.tip.hide(t,this),a.timeUpdate){var r=a.timeUpdate._groups[0].filter(function(t){return t.__data__.id===e+1});r.length&&a.timeTip.hide(t,r[0].children[1])}}).on("click",function(t){v.event.stopPropagation(),a.scope.handleSelectSpan(t)});c.append("circle").attr("class","node").attr("r",1e-6).style("fill",function(t){return t._children?e.sequentialScale(e.list.indexOf(t.data.serviceCode)):"#fff"}).attr("stroke",function(t){return e.sequentialScale(e.list.indexOf(t.data.serviceCode))}).attr("stroke-width",2.5),c.append("text").attr("font-size",11).attr("dy","-0.5em").attr("x",function(t){return t.children||t._children?-15:15}).attr("text-anchor",function(t){return t.children||t._children?"end":"start"}).text(function(t){return t.data.label.length>19?(t.data.isError?"◉ ":"")+t.data.label.slice(0,19)+"...":(t.data.isError?"◉ ":"")+t.data.label}).style("fill",function(t){return t.data.isError?"#E54C17":"#3d444f"}),c.append("text").attr("class","node-text").attr("x",function(t){return t.children||t._children?-15:15}).attr("dy","1em").attr("fill","#bbb").attr("text-anchor",function(t){return t.children||t._children?"end":"start"}).style("font-size","10px").text(function(t){return"".concat(t.data.layer||"").concat(t.data.component?"-"+t.data.component:t.data.component||"")}),c.append("rect").attr("rx",1).attr("ry",1).attr("height",2).attr("width",100).attr("x",function(t){return t.children||t._children?"-110":"10"}).attr("y",-1).style("fill","#00000020"),c.append("rect").attr("rx",1).attr("ry",1).attr("height",2).attr("width",function(t){return t.data.endTime&&t.data.startTime&&e.xScale(t.data.endTime-t.data.startTime)+1||0}).attr("x",function(t){return t.data.endTime&&t.data.startTime?t.children||t._children?-110+e.xScale(t.data.startTime-e.min):10+e.xScale(t.data.startTime-e.min):0}).attr("y",-1).style("fill",function(t){return e.sequentialScale(e.list.indexOf(t.data.serviceCode))});var o=c.merge(s);this.nodeUpdate=o,o.transition().duration(600).attr("transform",function(t){return"translate("+t.y+","+t.x+")"}),o.select("circle.node").attr("r",5).style("fill",function(t){return t._children?e.sequentialScale(e.list.indexOf(t.data.serviceCode)):"#fff"}).attr("cursor","pointer").on("click",function(t){v.event.stopPropagation(),function(t){t.children?(t._children=t.children,t.children=null):(t.children=t._children,t._children=null);a.update(t)}(t)});var l=s.exit().transition().duration(600).attr("transform",function(e){return"translate("+t.y+","+t.x+")"}).remove();l.select("circle").attr("r",1e-6),l.select("text").style("fill-opacity",1e-6);var d=this.svg.selectAll("path.tree-link").data(i,function(t){return t.id}).style("stroke-width",1.5);d.enter().insert("path","g").attr("class","tree-link").attr("d",function(e){var a={x:t.x0,y:t.y0};return h(a,a)}).style("stroke-width",1.5).merge(d).transition().duration(600).attr("d",function(t){return h(t,t.parent)});d.exit().transition().duration(600).attr("d",function(e){var a={x:t.x,y:t.y};return h(a,a)}).style("stroke-width",1.5).remove();function h(t,e){return"M ".concat(t.y," ").concat(t.x,"\n      C ").concat((t.y+e.y)/2," ").concat(t.x,", ").concat((t.y+e.y)/2," ").concat(e.x,",\n      ").concat(e.y," ").concat(e.x)}n.forEach(function(t){t.x0=t.x,t.y0=t.y})}},{key:"setDefault",value:function(){v.selectAll(".time-inner").style("opacity",1),v.selectAll(".time-inner-duration").style("opacity",0),v.selectAll(".trace-tree-node-selfdur").style("opacity",0),v.selectAll(".trace-tree-node-selfchild").style("opacity",0),this.nodeUpdate._groups[0].forEach(function(t){v.select(t).style("opacity",1)})}},{key:"getTopChild",value:function(){var t=this;v.selectAll(".time-inner").style("opacity",1),v.selectAll(".time-inner-duration").style("opacity",0),v.selectAll(".trace-tree-node-selfdur").style("opacity",0),v.selectAll(".trace-tree-node-selfchild").style("opacity",1),this.nodeUpdate._groups[0].forEach(function(e){v.select(e).style("opacity",.2),e.__data__.data.children.length>=t.topChildMin&&e.__data__.data.children.length<=t.topChildMax&&v.select(e).style("opacity",1)})}},{key:"getTopSlow",value:function(){var t=this;v.selectAll(".time-inner").style("opacity",0),v.selectAll(".time-inner-duration").style("opacity",1),v.selectAll(".trace-tree-node-selfchild").style("opacity",0),v.selectAll(".trace-tree-node-selfdur").style("opacity",1),this.nodeUpdate._groups[0].forEach(function(e){v.select(e).style("opacity",.2),e.__data__.data.dur>=t.topSlowMin&&e.__data__.data.dur<=t.topSlowMax&&v.select(e).style("opacity",1)})}},{key:"getZoomBehavior",value:function(t){return v.zoom().scaleExtent([.3,10]).on("zoom",function(){t.attr("transform","translate(".concat(v.event.transform.x+120,",").concat(v.event.transform.y,")scale(").concat(v.event.transform.k,")"))})}}]),t}(),w={components:{TraceSpanLogs:I.a},props:["data","traceId"],data:function(){return{segmentId:[],showDetail:!1,list:[],currentSpan:[]}},watch:{data:function(){this.data.length&&(v.select(".trace-tree-inner").selectAll("svg").selectAll("svg").remove(),this.changeTree(),this.tree.init({label:"".concat(this.traceId),children:this.segmentId},this.data))}},mounted:function(){window.addEventListener("resize",this.resize),this.changeTree(),this.tree=new x(this.$refs.traceTree,this),this.tree.init({label:"".concat(this.traceId),children:this.segmentId},this.data)},beforeDestroy:function(){window.removeEventListener("resize",this.resize)},methods:{copy:g.a,handleSelectSpan:function(t){this.currentSpan=t.data,this.showDetail=!0},traverseTree:function(t,e,a,r){if(t&&!t.isBroken)if(t.spanId!=e||t.segmentId!=a){if(t.children&&t.children.length>0)for(var n=0;n<t.children.length;n++)this.traverseTree(t.children[n],e,a,r)}else t.children.push(r)},computedScale:function(t){return v.scaleSequential().domain([0,this.list.length+1]).interpolator(v.interpolateCool)(t)},changeTree:function(){var t=this;if(0===this.data.length)return[];this.list=f()(new p.a(this.data.map(function(t){return t.serviceCode}))),this.segmentId=[];var e={},a=[],r=[],n=[];for(var i in this.data.forEach(function(e){if(-1===e.parentSpanId)n.push(e);else{var a=t.data.findIndex(function(t){return t.segmentId===e.segmentId&&t.spanId===e.spanId-1}),i={traceId:e.traceId,segmentId:e.segmentId,spanId:e.spanId-1,parentSpanId:e.spanId-2};-1!==a||b.a.find(r,i)||r.push(Object(h.a)({},i,{refs:[],endpointName:"VNode: ".concat(e.segmentId),serviceCode:"VirtualNode",type:"[Broken] ".concat(e.type),peer:"",component:"VirtualNode: #".concat(e.spanId-1),isError:!0,isBroken:!0,layer:"Broken",tags:[],logs:[]}))}}),n.forEach(function(e){e.refs.length&&e.refs.forEach(function(e){if(-1===t.data.findIndex(function(t){return e.parentSegmentId===t.segmentId&&e.parentSpanId===t.spanId})){var a=e.parentSpanId,n={traceId:e.traceId,segmentId:e.parentSegmentId,spanId:a,parentSpanId:a>-1?0:-1};if(!b.a.find(r,n)&&r.push(Object(h.a)({},n,{refs:[],endpointName:"VNode: ".concat(e.parentSegmentId),serviceCode:"VirtualNode",type:"[Broken] ".concat(e.type),peer:"",component:"VirtualNode: #".concat(a),isError:!0,isBroken:!0,layer:"Broken",tags:[],logs:[]})),n.parentSpanId>-1){var i={traceId:e.traceId,segmentId:e.parentSegmentId,spanId:0,parentSpanId:-1};!b.a.find(r,i)&&r.push(Object(h.a)({},i,{refs:[],endpointName:"VNode: ".concat(e.parentSegmentId),serviceCode:"VirtualNode",type:"[Broken] ".concat(e.type),peer:"",component:"VirtualNode: #0",isError:!0,isBroken:!0,layer:"Broken",tags:[],logs:[]}))}}})}),[].concat(r,Object(d.a)(this.data)).forEach(function(t){t.label=t.endpointName||"no operation name",t.children=[],void 0===e[t.segmentId]?(a.push(t.segmentId),e[t.segmentId]=[],e[t.segmentId].push(t)):e[t.segmentId].push(t)}),a.forEach(function(a){var r=e[a].sort(function(t,e){return e.parentSpanId-t.parentSpanId});r.forEach(function(e){var a=r.findIndex(function(t){return t.spanId===e.parentSpanId});if(-1!==a&&(r[a].isBroken&&-1===r[a].parentSpanId||!r[a].isBroken)&&(r[a].children.push(e),r[a].children.sort(function(t,e){return t.spanId-e.spanId})),e.isBroken){var n,i=b.a.filter(t.data,function(t){return b.a.find(t.refs,{traceId:e.traceId,parentSegmentId:e.segmentId,parentSpanId:e.spanId})});i.length>0&&(n=e.children).push.apply(n,Object(d.a)(i))}}),e[a]=r[r.length-1]}),a.forEach(function(a){e[a].refs.forEach(function(r){r.traceId===t.traceId&&t.traverseTree(e[r.parentSegmentId],r.parentSpanId,r.parentSegmentId,e[a])})}),e)0===e[i].refs.length&&this.segmentId.push(e[i]);this.segmentId.forEach(function(e,a){t.collapse(t.segmentId[a])})},collapse:function(t){var e=this;if(t.children){var a=t.endTime-t.startTime;t.children.forEach(function(t){a-=t.endTime-t.startTime}),t.dur=a<0?0:a,t.children.forEach(function(t){return e.collapse(t)})}},resize:function(){this.tree.resize()},showCurrentSpanDetail:function(t,e){var a=this,r=20.2*e.split("\n").length+10,n=.9*window.innerHeight;r=r>=n?n:r,this.$modal.show("dialog",{title:t,text:'<div style="height:'.concat(r,'px">').concat(e,"</div>"),buttons:[{title:"Copy",handler:function(){a.copy(e)}},{title:"Close"}]})}}},O=(a("ec5e"),Object(k.a)(w,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"trace-tree-charts scroll_hide flex-v"},[a("transition-group",{staticStyle:{padding:"10px 30px"},attrs:{name:"fade",tag:"div"}},t._l(t.list,function(e,r){return a("span",{key:e,staticClass:"time-charts-item mr-10",style:"color:"+t.computedScale(r)},[a("svg",{staticClass:"icon vm mr-5 sm"},[a("use",{attrs:{"xlink:href":"#issue-open-m"}})]),a("span",[t._v(t._s(e))])])}),0),a("div",{staticStyle:{padding:"0 30px"}},[a("a",{staticClass:"trace-tree-btn mr-10",on:{click:function(e){return t.tree.setDefault()}}},[t._v("Default")]),a("a",{staticClass:"trace-tree-btn mr-10",on:{click:function(e){return t.tree.getTopSlow()}}},[t._v("Top 5 of slow")]),a("a",{staticClass:"trace-tree-btn mr-10",on:{click:function(e){return t.tree.getTopChild()}}},[t._v("Top 5 of children")])]),a("rk-sidebox",{attrs:{width:"50%",show:t.showDetail,title:t.$t("spanInfo")},on:{"update:show":function(e){t.showDetail=e}}},[a("TraceSpanLogs",{attrs:{currentSpan:t.currentSpan}})],1),a("div",{staticClass:"trace-tree",staticStyle:{height:"100%"}},[a("div",{ref:"traceTree",staticClass:"trace-tree-inner"})])],1)},[],!1,null,null,null).exports),N=a("3e56"),A=a("4bb5"),L=a("0187"),R=function(t){function e(){var t;return Object(r.a)(this,e),(t=Object(i.a)(this,Object(s.a)(e).apply(this,arguments))).mode=!0,t.displayMode="list",t.showTraceLogs=!1,t.pageSize=10,t.pageNum=1,t.traceId="",t}return Object(c.a)(e,t),Object(n.a)(e,[{key:"handleClick",value:function(t){var e=null;e=1===t.length?t[0]:t.join(","),Object(g.a)(e)}},{key:"changeTraceId",value:function(t){this.traceId=t,this.GET_TRACE_SPANS({traceId:t})}},{key:"turnLogsPage",value:function(t){this.pageNum=t,this.searchTraceLogs()}},{key:"searchTraceLogs",value:function(){this.showTraceLogs=!0,this.GET_TRACE_SPAN_LOGS({condition:{relatedTrace:{traceId:this.traceId||this.current.traceIds[0]},paging:{pageNum:this.pageNum,pageSize:this.pageSize,needTotal:!0}}})}}]),e}(l.d);o.a([Object(A.d)("rocketTrace")],R.prototype,"rocketTrace",void 0),o.a([Object(A.a)("rocketTrace/GET_TRACE_SPANS")],R.prototype,"GET_TRACE_SPANS",void 0),o.a([Object(A.a)("rocketTrace/GET_TRACE_SPAN_LOGS")],R.prototype,"GET_TRACE_SPAN_LOGS",void 0),o.a([Object(l.b)()],R.prototype,"spans",void 0),o.a([Object(l.b)()],R.prototype,"current",void 0);var D=R=o.a([Object(l.a)({components:{TraceDetailChartList:E,TraceDetailChartTree:O,TraceDetailChartTable:N.a,LogTable:L.a}})],R),j=(a("e709"),Object(k.a)(D,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rk-trace-detail flex-v"},[a("rk-sidebox",{staticClass:"rk-log-box",attrs:{width:"100%",show:t.showTraceLogs,title:t.$t("relatedTraceLogs")},on:{"update:show":function(e){t.showTraceLogs=e}}},[a("RkPage",{attrs:{currentSize:t.pageSize,currentPage:t.pageNum,total:t.rocketTrace.traceLogsTotal},on:{changePage:t.turnLogsPage}}),a("LogTable",{attrs:{tableData:t.rocketTrace.traceSpanLogs||[],type:"service",noLink:!0}},[t.rocketTrace.traceSpanLogs.length?t._e():a("div",{staticClass:"log-tips"},[t._v(t._s(t.$t("noData")))])])],1),t.current.endpointNames?a("div",{staticClass:"rk-trace-detail-wrapper clear"},[a("h5",{staticClass:"mb-5 mt-0"},[t.current.isError?a("rk-icon",{staticClass:"red mr-5 sm",attrs:{icon:"clear"}}):t._e(),a("span",{staticClass:"vm"},[t._v(t._s(t.current.endpointNames[0]))]),a("div",{staticClass:"rk-trace-log-btn bg-blue r mr-10",on:{click:t.searchTraceLogs}},[t._v(t._s(t.$t("viewLogs")))])],1),a("div",{staticClass:"mb-5 blue sm"},[a("select",{staticClass:"rk-trace-detail-ids",on:{change:function(e){return t.changeTraceId(t.i)}}},t._l(t.current.traceIds,function(e){return a("option",{key:e,domProps:{value:e}},[t._v(t._s(e))])}),0),a("svg",{staticClass:"icon vm grey link-hover cp ml-5",on:{click:function(e){return t.handleClick(t.current.traceIds)}}},[a("use",{attrs:{"xlink:href":"#review-list"}})])]),a("a",{staticClass:"rk-btn mr-5 sm r",class:{ghost:"table"!==t.displayMode},on:{click:function(e){t.displayMode="table"}}},[a("svg",{staticClass:"icon vm sm rk-trace-table_svg-icon"},[a("use",{attrs:{"xlink:href":"#table"}})]),t._v("\n      "+t._s(t.$t("table")))]),a("a",{staticClass:"rk-btn mr-5 sm r",class:{ghost:"tree"!==t.displayMode},on:{click:function(e){t.displayMode="tree"}}},[a("svg",{staticClass:"icon vm sm"},[a("use",{attrs:{"xlink:href":"#issue-child"}})]),t._v("\n      "+t._s(t.$t("tree")))]),a("a",{staticClass:"rk-btn mr-5 sm r",class:{ghost:"list"!==t.displayMode},on:{click:function(e){t.displayMode="list"}}},[a("svg",{staticClass:"icon vm sm"},[a("use",{attrs:{"xlink:href":"#list-bulleted"}})]),t._v("\n      "+t._s(t.$t("list")))]),a("div",{staticClass:"rk-tag mr-5"},[t._v(t._s(t.$t("start")))]),a("span",{staticClass:"mr-15 sm"},[t._v(t._s(t._f("dateformat")(parseInt(t.current.start))))]),a("div",{staticClass:"rk-tag mr-5"},[t._v(t._s(t.$t("duration")))]),a("span",{staticClass:"mr-15 sm"},[t._v(t._s(t.current.duration)+" ms")]),a("div",{staticClass:"rk-tag mr-5"},[t._v(t._s(t.$t("spans")))]),a("span",{staticClass:"sm"},[t._v(t._s(t.spans.length))])]):t._e(),"list"==t.displayMode&&t.current.endpointNames?a("TraceDetailChartList",{attrs:{data:t.spans,traceId:t.current.traceIds[0]}}):t._e(),"tree"==t.displayMode&&t.current.endpointNames?a("TraceDetailChartTree",{attrs:{data:t.spans,traceId:t.current.traceIds[0]}}):t._e(),"table"==t.displayMode&&t.current.endpointNames?a("TraceDetailChartTable",{attrs:{data:t.spans,traceId:t.current.traceIds[0],showBtnDetail:!1}}):t._e(),t.current.endpointNames?t._e():a("div",{staticClass:"flex-h container"},[a("svg",{staticClass:"icon rk-icon-trace"},[a("use",{attrs:{"xlink:href":"#unlink"}})])])],1)},[],!1,null,"26341adb",null));e.a=j.exports},a82d:function(t,e,a){},c251:function(t,e,a){"use strict";var r=a("26a4");a.n(r).a},e63d:function(t,e,a){"use strict";var r=a("a82d");a.n(r).a},e709:function(t,e,a){"use strict";var r=a("7e8c");a.n(r).a},ec5e:function(t,e,a){"use strict";var r=a("2b1b");a.n(r).a}}]);